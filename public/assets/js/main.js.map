{"version":3,"sources":["01-main.js","02-render-resultCard.js","03-render-fav-card.js","04-render-info.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["'use strict';\n\n// CONTROLES --------------------------------------------------\n\n//fijos\nconst searchForm = document.getElementById('searchForm');\nconst searchInput = document.getElementById('searchInput');\nconst searchButton = document.getElementById('searchButton');\n\n//dinámicos\n\nconst clearFavPannel = document.createElement('button');\nclearFavPannel.classList.add('aside__favList--clearButton', 'button__lightLong', 'text__lightButton');\nconst clearFavPannelContent = document.createTextNode('vaciar favoritos');\nclearFavPannel.appendChild(clearFavPannelContent);\nclearFavPannel.addEventListener('click', function () { emptyFavPannel() });\n/*el botón se añadirá: a. si al cargar la página existen favoritos b. si no hay favoritos y añadimos uno\nel botón se borrará si  a. eliminamos el último favorito b. hacemos click en él*/\n\n\n// DATOS DE PARTIDA ---------------------------------------------\n\nconst urlShowSearchByName = 'http://api.tvmaze.com/search/shows?';\nconst urlShowSearchById = 'http://api.tvmaze.com/shows/';\n\n// RESULTADOS ---------------------------------------------------\n\nconst mainSection = document.querySelector('.mainSection');\n\nconst searchResultsIntro = document.getElementById('searchResultsIntro');\nconst searchResultsInstructions = document.getElementById('searchResultsInstructions');\nconst alertText = document.getElementById('alerText');\n\nconst searchResultsList = document.getElementById('searchResultsList');\nlet searchResultShows = null; // recibe resultados del servidor\n\nconst favList = document.getElementById('favList');\nlet favShows = []; // recibe elementos añadidos con push\n\nconst showInfoBox = document.getElementById('showInfo');\n\n\n\n// Al cargar la página --------------------------------------------\n\nconst savedFavs = JSON.parse(localStorage.getItem('favShows'));\nif (savedFavs !== null && savedFavs.length !== 0) {\n  favList.appendChild(clearFavPannel);\n  savedFavs.map(fav => addOrRemoveFavourite(fav));\n}\n\n\n// ACCIONES ------------------------------------------------------------------------------------------------\n\n//Gestión de FAVORITOS ------------------------------------\n\nfunction emptyFavPannel() {\n  favShows.map(fav => changeCardStyle(fav));\n  const FavsToRemove = favShows.map(fav => fav);\n  FavsToRemove.reverse();\n  FavsToRemove.map(fav => addOrRemoveFavourite(fav));\n};\n\n\nfunction getFavInfo(id) {\n  fetch(urlShowSearchById + id)\n    .then(function (response) {\n      if (!response.ok) { throw response; }\n      return response.json();\n    })\n    .then(function (data) {\n      let newFav = data;\n      renderFav(newFav)\n    })\n    .catch(error => console.log(`Ha sucedido un error: ${error}`));\n\n};\n\nfunction addOrRemoveFavourite(id) {\n  alertText.innerHTML = '';\n  if (parseInt(favShows.indexOf(id)) === (-1)) {\n    if (favShows.length >= 10) {\n      window.location = '#';\n      mainSection.scroll(0, 0);\n      const alertTextContent = document.createTextNode(\n        '* Tu listado de favoritos está completo. Por favor, elimina alguno antes de añadir uno nuevo.'\n      );\n      alertText.appendChild(alertTextContent);\n      changeCardStyle(id);\n    } else {\n      favShows.push(id);\n      getFavInfo(id);\n      if (favList.innerHTML.length === 0) {\n        favList.appendChild(clearFavPannel);\n      }\n    }\n  } else {\n    favShows.splice(parseInt(favShows.indexOf(id)), 1);\n    document.getElementById(id + 'FAV').remove();\n    if (favShows.length < 1) {\n      favList.removeChild(clearFavPannel);\n    }\n  }\n  localStorage.setItem('favShows', JSON.stringify(favShows));\n};\n\nfunction changeCardStyle(id) {\n  if (document.getElementById(id) !== null) {\n    document.getElementById(id).classList.toggle('main__favShowStyle');\n    document.getElementById(id).children[0].classList.toggle('text__card--titleFav');\n  }\n}\n\n//Gestión de resultados de BÚSQUEDA ------------------------------------\n\n\nfunction countResults(count, text) {\n  searchResultsIntro.innerHTML = '';\n  searchResultsInstructions.innerHTML = '';\n  const searchResultsIntroContent = document.createTextNode(\n    `Tenemos ${count} resultados para tu búsqueda \"${text}\", ordenados por popularidad.`\n  );\n  searchResultsIntro.appendChild(searchResultsIntroContent);\n  const searchResultsInstructionsContent = document.createTextNode(\n    'Haz click sobre una serie para añadirla a favoritos y ver más información.'\n  );\n  searchResultsInstructions.appendChild(searchResultsInstructionsContent);\n}\n\nfunction showSearchByName() {\n  let query = searchInput.value;\n  fetch(`${urlShowSearchByName}q=${query}`)\n    .then(function (response) {\n      if (!response.ok) { throw response; }\n      return response.json();\n    })\n    .then(function (data) {\n      searchResultShows = data;\n      countResults(searchResultShows.length, query);\n      for (let show of searchResultShows) {\n        renderSearchResultShows(show);\n      }\n    })\n    .catch(error => console.log(`Ha sucedido un error: ${error}`));\n};\n\nfunction handleSearchButton(event) {\n  event.preventDefault();\n  searchResultsList.innerHTML = '';\n  alertText.innerHTML = '';\n  showInfoBox.innerHTML = '';\n  if (searchInput.value.length !== 0) {\n    showSearchByName();\n  }\n  searchForm.reset();\n}\n\nsearchButton.addEventListener('click', handleSearchButton);\n\n","function renderSearchResultShows(show) {\n\n  //LI\n  const resultCard = document.createElement('li');\n  resultCard.id = show.show.id;\n  resultCard.classList.add('main__resultsList--card');\n  if (parseInt(favShows.indexOf(resultCard.id)) !== (-1)) {\n    resultCard.classList.add('main__favShowStyle')\n  }\n  searchResultsList.appendChild(resultCard);\n\n  //TITLE\n  const resultCardTitle = document.createElement('p');\n  resultCardTitle.classList.add('main__resultsList--title', 'text__card--title');\n  if (parseInt(favShows.indexOf(resultCard.id)) !== (-1)) {\n    resultCardTitle.classList.add('text__card--titleFav');\n  }\n  resultCard.appendChild(resultCardTitle);\n  const resultCardTitleContent = document.createTextNode(show.show.name);\n  resultCardTitle.appendChild(resultCardTitleContent);\n\n  //IMAGE\n  const resultCardImage = document.createElement('img');\n  resultCardImage.classList.add('main__resultsList--image');\n  const imageSource = show.show.image !== null ? show.show.image.medium : 'https://via.placeholder.com/210x295?text=TV';\n  resultCardImage.src = imageSource;\n  resultCard.appendChild(resultCardImage);\n\n  // make card react on clicks\n  resultCard.addEventListener('click', function () {\n    addOrRemoveFavourite(resultCard.id);\n    changeCardStyle(resultCard.id);\n  });\n};\n","function renderFav(newFav) {\n\n    //LI\n    const favCard = document.createElement('li');\n    favCard.id = newFav.id + 'FAV';\n    favCard.classList.add('aside__favList--card');\n    favList.appendChild(favCard);\n\n    //IMAGE\n    const favImage = document.createElement('img');\n    const imageSource = newFav.image !== null ? newFav.image.medium : 'https://via.placeholder.com/210x295?text=TV';\n    favImage.classList.add('aside__favList--image');\n    favImage.src = imageSource;\n    favCard.appendChild(favImage);\n\n    //infoBox\n    const favInfoBox = document.createElement('div');\n    favInfoBox.setAttribute('class', 'aside__favList--infoBox');\n    favCard.appendChild(favInfoBox);\n\n    //infoBoxTexts\n    const favInfoBoxTexts = document.createElement('div');\n    favInfoBoxTexts.setAttribute('class', 'aside__favList--infoBoxTexts');\n    favInfoBox.appendChild(favInfoBoxTexts);\n\n    //TITLE\n    const favTitle = document.createElement('p');\n    favTitle.classList.add('aside__favList--title', 'text__card--title');\n    favInfoBoxTexts.appendChild(favTitle);\n    const favTitleContent = document.createTextNode(newFav.name);\n    favTitle.appendChild(favTitleContent);\n\n    // info link\n    const favInfoLink = document.createElement('div');\n    favInfoLink.classList.add('aside__favList--infoLink', 'button__grayLong', 'text__greyButton');\n    favInfoBoxTexts.appendChild(favInfoLink);\n    const favInfoLinkContent = document.createTextNode('+ info');\n    favInfoLink.appendChild(favInfoLinkContent);\n    // make info link react to click\n    favInfoLink.addEventListener('click', function () {\n        showInfo(newFav);\n    });\n\n    //DELETE BUTTON\n    const favDeleteButton = document.createElement('div');\n    favDeleteButton.classList.add('aside__favList--deleteButton', 'button__grayRound');\n    favInfoBox.appendChild(favDeleteButton);\n    const favDeleteButtonContent = document.createElement('i');\n    favDeleteButtonContent.classList.add('fas', 'fa-times', 'button__grayRound--icon');\n    favDeleteButton.appendChild(favDeleteButtonContent);\n    //make X icons react to click\n    favDeleteButton.addEventListener('click', function () {\n        addOrRemoveFavourite(newFav.id.toString());\n        changeCardStyle(newFav.id.toString());\n    });\n\n};\n","function showInfo(info) {\n    //Vaciar sección de info previa\n    searchResultsIntro.innerHTML = '';\n    searchResultsInstructions.innerHTML = '';\n    alertText.innerHTML = '';\n    searchResultsList.innerHTML = '';\n    showInfoBox.innerHTML = '';\n    //Dirigir la web a la sección de info\n    window.location = '#';\n    mainSection.scroll(0, 0);\n\n    const showInfoBoxContent = document.createElement('div');\n    showInfoBoxContent.classList.add('mainInfo__showContent');\n    showInfoBox.appendChild(showInfoBoxContent);\n\n    //IMAGE\n    const showImage = document.createElement('img');\n    showImage.classList.add('mainInfo__showContent--image');\n    const imageSource = info.image !== null ? info.image.original : 'https://via.placeholder.com/400x562?text=TV';\n    showImage.src = imageSource;\n    showInfoBoxContent.appendChild(showImage);\n\n    //Text box\n    const showInfoText = document.createElement('div');\n    showInfoText.classList.add('mainInfo__showContent--text');\n    showInfoBoxContent.appendChild(showInfoText);\n\n    //TITLE\n    const showTitle = document.createElement('p');\n    showTitle.classList.add('mainInfo__showContent--text-title', 'text__section--title');\n    showInfoText.appendChild(showTitle);\n    const showTitleContent = document.createTextNode(info.name);\n    showTitle.appendChild(showTitleContent);\n\n    //RATING\n    const showRating = document.createElement('p');\n    showRating.classList.add('mainInfo__showContent--text-rating', 'text__base');\n    showInfoText.appendChild(showRating);\n    const showRatingContent = document.createTextNode(info.rating.average);\n    showRating.appendChild(showRatingContent);\n\n    //SUMMARY\n    const showSummary = document.createElement('p');\n    showSummary.classList.add('mainInfo__showContent--text-summary', 'text__base');\n    showInfoText.appendChild(showSummary);\n    showSummary.innerHTML = info.summary;\n\n    //OFFICIAL SITE\n    const showOfficialSite = document.createElement('a');\n    showOfficialSite.classList.add('mainInfo__showContent--text-officialSite', 'text__base');\n    showInfoText.appendChild(showOfficialSite);\n    showOfficialSite.href = info.officialSite;\n    showOfficialSite.target = '_blank';\n    const showOfficialSiteContent = document.createTextNode(info.officialSite);\n    showOfficialSite.appendChild(showOfficialSiteContent);\n\n};\n"]}